/*! release-manager 2019-12-08 */

var App=function(t){"use strict";return t.releaseManager=function(){return $(".auth-type-container").hide(),$("select").select2(),$("#git-source-select").on("change",function(t){var e=$("option:selected",t.target);$("#git-api-url").val($(e).attr("data-api-url")),$("#git-file-url").val($(e).attr("data-file-url"))}),$("#git-source-auth").on("change",function(){var t=$('div[data-for="'+$(this).val()+'"]');$(".auth-type-container").hide(),$("input",$(t)).attr("required","required"),$(t).show()}),$("form#connection-config").on("submit",function(e){e.preventDefault();var i=t.buildConnectionParams();return!0===i[0]?($(this).attr("disabled","disabled"),$(this).text("...testing..."),t.testConnection(i[1],t.allowConfigSave)):t.notifier().showNotice("Missing Data","There appears to be data missing to make a connection","error"),!1}),$("button#config-save").on("click",function(){var e=t.buildConnectionParams();$(this).attr("disabled","disabled"),$(this).text("...saving..."),t.saveConnectionParams(e,t.redirect,{url:"someurl",p1:"this",p2:"that"})}),this.buildConnectionParams=function(){var t={},e=!0;$('.auth-type-container[data-for="'+$("#git-source-auth").val()+'"]').find("input").map(function(){""==$.trim(this.value)&&(e=!1),t[this.name]=$.trim(this.value)}),""==$.trim($("#git-api-url").val())&&(e=!1);var i={"git-source-select":$("#git-source-select").val(),"git-source-auth":$("#git-source-auth").val(),"git-api-url":$("#git-api-url").val(),"git-credentials":t};return[e,i]},this.allowConfigSave=function(e){console.log(e);var i=!1;e.success&&""==e.warnings?(t.showNotice("Connection Test","Connected test succeeded","success"),i=!0):e.msgs.length>0?t.showNotice("Connection Error",e.msgs.join("<br />"),"error"):e.warnings.length>0?(t.showNotice("Connection Test","Connected test succeeded: "+e.warnings,"warning"),i=!0):t.showNotice("Connection Error","Unknown response","error"),i&&($("button#config-save").removeClass("hidden"),$("button#config-save").focus()),$("button#connection-test").removeAttr("disabled"),$("button#connection-test").text("Test Connection")},this.redirect=function(t){var e=t.url;for(var i in delete t.url,t)e+=i+"="+t[i]+"&";e=e.substr(0,-1),location.href=e},{allowConfigSave:this.allowConfigSave,redirect:this.redirect}},t}((App=function(t){"use strict";return t.notifier=function(){return this.notifierConfig={animation:!0,delay:{show:250,hide:500},html:!0},$("#notifier").on("click",t.notifier.hide),this.showNotice=function(e,i,n){$("#notifier").find(".alert-title").text(e),$("#notifier").find(".alert-body").text(i),"success"==n?($("#notifier").removeClass("bg-warning"),$("#notifier").removeClass("bg-danger"),$("#notifier").addClass("bg-success")):"error"==n?($("#notifier").removeClass("bg-warning"),$("#notifier").addClass("bg-danger"),$("#notifier").removeClass("bg-success")):($("#notifier").addClass("bg-warning"),$("#notifier").removeClass("bg-danger"),$("#notifier").removeClass("bg-success")),t.notifier.show()},$(".unseen-notification").each(function(){t.showNotice($(this).attr("data-title"),$(this).text(),$(this).attr("data-status")),$(this).remove()}),this},t.notifier.show=function(){return t.notifierConfig.animation?$("#notifier").animate({opacity:1,top:"66px"}):$("#notifier").show(),this},t.notifier.hide=function(){return t.notifierConfig.animation?$("#notifier").animate({opacity:0,top:0}):$("#notifier").hide(),this},t.notifier.resize=function(){return $("#notifier").css({left:$(".card:first").offset().left+"px",right:$(".card:first").offset().left+"px",maxWidth:$(".card:first").css("width")}),this},t}((App=function(t){"use strict";return $(document).ajaxStart(function(){t.showLoader()}),$(document).ajaxStop(function(){t.hideLoader()}),$(document).ajaxError(function(e,i,n,o){t.showNotice("Event Error",o,"error"),t.hideLoader()}),t.connector=function(){return this.showLoader=function(){$("#loader").show()},this.hideLoader=function(){$("#loader").hide()},this.testConnection=function(t,e){$.ajax({data:t,method:"post",url:"/test-connection",complete:function(t){console.log(t.responseText);var i=JSON.parse(t.responseText);e(i)}})},this.saveConnectionParams=function(t,e,i){$.ajax({data:t,method:"post",url:"/save-connection-params",complete:function(t){void 0===i&&(i=JSON.parse(t.responseText)),e(i)}})},this.hideLoader(),this},t}(App||{}))||{}))||{});